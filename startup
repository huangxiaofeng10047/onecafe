#!/bin/sh


#检测开发模式还是生产模式启动
if [ -n "$0" ] && [ "$1" = "dev" ]
then
  echo "开发模式启动"
else
  export NODE_ENV=production
  export PORT=80
  echo "生产模式启动"
fi


#检测redis是否启动
redisPid=`ps -ef | grep "redis-server" | grep -v grep |  awk "{print $2}"`
if [ -z "$redisPid" ]
then
  echo "请先启动redis"
  exit 1
fi


#检测mongodb是否启动
mongodbPid=`ps -ef | grep "mongodb" | grep -v grep |  awk "{print $2}"`
if [ -z "$mongodbPid" ]
then
  echo "先请启动mongodb"
  exit 1
fi

#启动项目
echo "启动项目"
node bin/www
